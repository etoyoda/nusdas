# Makefile for libnwprpack

CC		= @CC@
prefix          = @prefix@
exec_prefix     = @exec_prefix@
LIBDIR		= @libdir@
INCDIR		= @includedir@
CFLAGS		= @CFLAGS@ -I../libnwprpack
CPPFLAGS	= @CPPFLAGS@
DEFS		= @DEFS@
LDFLAGS		= @LDFLAGS@
LIBS		= @LIBS@
ARCHIVER	= @ARCHIVER@
ARFLAGS		= @ARFLAGS@
INSTALLF        = cp -f
INSTALLD        = mkdir -p

OBJ_SRF_C = r_pack.o

SRCS = $(OBJ_SRF_C:.o=.c)
HDRS = config.h
OBJS = $(OBJ_SRF_C)
LIBRARY = libnwp_rpack.a

.SUFFIXES:
.SUFFIXES: .o .c


all: all_@SRF_AVAILABLE@

.PHONY: all_no install_no

all_no:

all_yes: $(LIBRARY)

.c.o:
	$(CC) -c $(CFLAGS) $(CPPFLAGS) $<

$(LIBRARY): $(OBJS)
	$(ARCHIVER) $(ARFLAGS) $(LIBRARY) $(OBJS)

echo-objs-srf:
	@echo OBJS=$(OBJS)

clear: decharset
	-rm -f *.o *.mod *.bak *~

clean: clear
	-rm -f $(LIBRARY)

distclean: clean
	-rm -f config.h utf8 euc-jp shift_jis Makefile

clean.all: distclean
	-rm -f casplit

tags:
	ctags [a-t]*.c *.h

HEADERS_to_INSTALL =
INCS_to_INSTALL = $(HEADERS_to_INSTALL)

install: install_@SRF_AVAILABLE@

install_no:

install_yes: all
	test -d $(LIBDIR) || $(INSTALLD) $(LIBDIR)
	$(INSTALLF) $(LIBRARY) $(LIBDIR)/

charset: @CHARSET@

decharset: utf8

shift_jis: $(SRCS) $(HDRS)
	if [ ! -f shift_jis ] ;\
	then \
		for file in $(SRCS) $(HDRS) ;\
		do \
			@EUCTOSJIS@ < $$file > xconv.tmp && \
			mv -f xconv.tmp $$file ;\
		done ;\
	fi
	-rm -f euc-jp utf8
	touch shift_jis

euc-jp: $(SRCS) $(HDRS)
	if [ ! -f euc-jp ] ;\
	then \
		for file in $(SRCS) $(HDRS) ;\
		do \
			@SJISTOEUC@ < $$file > xconv.tmp && \
			mv -f xconv.tmp $$file ;\
		done ;\
	fi
	-rm -f shift_jis utf8
	touch euc-jp

utf8: $(SRCS) $(HDRS)
	if [ ! -f utf8 ] ;\
	then \
		for file in $(SRCS) $(HDRS) ;\
		do \
			nkf -w < $$file > xconv.tmp && \
			mv -f xconv.tmp $$file ;\
		done ;\
	fi
	-rm -f shift_jis euc-jp
	touch utf8

doc: charset
	ruby -I../src ../src/cprodoc.rb \
 --cppflags '-C -I../src -I../nwplib8' \
 -f srf_amd_aqc,srf_amd_rdic,srf_search_amdstn,srf_amd_slct \
 -f srf_lv_set,srf_lv_trans,srf_rd_rdic,rdr_lv_trans \
 -o ../doc/capi_@.tex s*.c
	ruby -I../src ../src/cprodoc.rb \
 --cppflags '-C -I../src -I../nwplib8' \
 -f srf_amd_aqc,srf_amd_rdic,srf_search_amdstn,srf_amd_slct \
 -f srf_lv_set,srf_lv_trans,srf_rd_rdic,rdr_lv_trans \
 --lang Fortran -m upcase \
 -o ../doc/fapi_@.tex s*.c

#
# --- following lines are generated by makedepend(1) ---
# If you have edited *.c source code, just type:
#   make casplit
#   makedepend -f Makefile.in -Y. *.c
#
# DO NOT DELETE

r_pack.o: config.h
